(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){e.exports=n(31)},26:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(14),s=n.n(r),c=n(33),l=n(5),i=n(6),u=n(9),h=n(7),d=n(10),f=n(34),m=n(15),b=n(12),k="https://reactnd-books-api.udacity.com",p=localStorage.token;p||(p=localStorage.token=Math.random().toString(36).substr(-8));var v={Accept:"application/json",Authorization:p},E=function(e){return fetch("".concat(k,"/books/").concat(e),{headers:v}).then(function(e){return e.json()}).then(function(e){return e.book})},g=function(e,t){return fetch("".concat(k,"/books/").concat(e.id),{method:"PUT",headers:Object(b.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},y=n(32);var S=function(e){var t=document.location.pathname,n=e.onShelfChange,a=e.addBook;return o.a.createElement("div",{className:"book-shelf-changer"},o.a.createElement("select",{value:e.shelf,"data-bookid":e.id,id:e.index,className:e.shelf,onChange:function(e){return"/"===t?n()()()(e):a()()(e)}},o.a.createElement("option",{value:"move",disabled:!0},"Move to..."),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")))};var N=function(e){return o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(e.url,")")}}),o.a.createElement(S,{id:e.id,index:e.index,shelf:e.shelf,onShelfChange:function(){return e.onShelfChange},addBook:function(){return e.addBook}})),o.a.createElement("div",{className:"book-title"},e.title),o.a.createElement("div",{className:"book-authors"},e.authors))},C=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentWillUnmount",value:function(){this.props.updateQuery("")}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(y.a,{to:"/",className:"close-search"},"Close"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",placeholder:"Search by title or author",onChange:function(t){return e.props.updateQuery(t.target.value)}}))),o.a.createElement("div",{className:"search-books-results"},o.a.createElement("ol",{className:"books-grid"},this.props.books?this.props.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(N,{id:t.id,shelf:t.shelf,addBook:function(){return e.props.addBook},title:t.title,authors:t.authors,url:t.imageLinks?t.imageLinks.thumbnail:null}))}):null)))}}]),t}(a.Component);var j=function(e){return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},e.title),o.a.createElement("div",{className:"bookshelf-books"},o.a.createElement("ol",{className:"books-grid"},e.books.map(function(t,n){return t.shelf.toLowerCase()===e.title.replace(/\s/g,"").toLowerCase()?o.a.createElement("li",{key:t.id},o.a.createElement(N,{index:n,shelf:t.shelf,onShelfChange:function(){return e.onShelfChange},title:t.title,authors:t.authors,url:t.imageLinks.thumbnail})):null}))))};var O=function(){return o.a.createElement("div",{className:"open-search"},o.a.createElement(y.a,{to:"/search"},"Add a book"))};var w=function(e){return o.a.createElement("div",{className:"list-books"},o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,"MyReads")),o.a.createElement("div",{className:"list-books-content"},o.a.createElement(j,{onShelfChange:function(){return e.onShelfChange},books:e.books,title:"Currently Reading"}),o.a.createElement(j,{onShelfChange:function(){return e.onShelfChange},books:e.books,title:"Read"}),o.a.createElement(j,{onShelfChange:function(){return e.onShelfChange},books:e.books,title:"Want to Read"})),o.a.createElement(O,null))},R=(n(26),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={query:"",books:[],results:[]},n.bookShelfChangeHandler=function(e){var t=Number(e.target.id),a=e.target.value;n.setState(function(e){return{books:e.books.map(function(e,n){return n===t&&(e.shelf=a,g(e,a)),e})}})},n.updateQuery=function(e){n.setState({query:e.trim()})},n.addToList=function(e){var t=e.target.value,a=e.target.getAttribute("data-bookid"),o=n.state.books;E(a).then(function(e){e.shelf=t;var a=0;o.map(function(t){return e.id!==t.id&&a++,a===o.length&&n.setState(function(){return{books:n.state.books.push(e)}}),e}),n.setState(function(){return{books:o.map(function(n){return n.id===e.id&&(n.shelf=t),n})}}),g(e,t)})},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"debounceEvent",value:function(){var e=this;return this.debounceEvent=m.debounce.apply(void 0,arguments),function(t){return t.persist(),e.debounceEvent(t)}}},{key:"componentDidMount",value:function(){var e=this;fetch("".concat(k,"/books"),{headers:v}).then(function(e){return e.json()}).then(function(e){return e.books}).then(function(t){e.setState({books:t})})}},{key:"componentDidUpdate",value:function(e){var t=this;this.debounceEvent(function(){var n=t.state.query;n!==e.query&&""===n&&(n=" "),n!==e.query&&function(e){return fetch("".concat(k,"/search"),{method:"POST",headers:Object(b.a)({},v,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})}(n).then(function(e){Array.isArray(e)&&t.setState(function(){return{results:e.map(function(e){return e.shelf="none",t.state.books.map(function(t){return t.id===e.id&&(e.shelf=t.shelf),e}),e})}}),void 0!==e&&e.hasOwnProperty("error")&&t.setState({results:[]})})},1e3)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement(f.a,{path:"/search",render:function(){return o.a.createElement(C,{books:e.state.results,updateQuery:function(t){return e.updateQuery(t)},addBook:e.addToList})}}),o.a.createElement(f.a,{exact:!0,path:"/",render:function(){return o.a.createElement(w,{books:e.state.books,onShelfChange:e.bookShelfChangeHandler})}}))}}]),t}(o.a.Component));n(29);s.a.render(o.a.createElement(c.a,{basename:"/myreads-react-project"},">",o.a.createElement(R,null)),document.getElementById("root"))}},[[17,2,1]]]);
//# sourceMappingURL=main.c0af55e7.chunk.js.map